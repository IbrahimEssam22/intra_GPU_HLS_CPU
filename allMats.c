static const unsigned char test_block[8][8] = {
        {79, 79, 79, 79, 79, 78, 78, 78},
        {79, 79, 79, 79, 79, 78, 78, 78},
        {79, 79, 79, 79, 79, 78, 78, 78},
        {78, 79, 79, 79, 79, 78, 78, 78},
        {79, 79, 78, 78, 78, 77, 77, 77},
        {79, 79, 78, 78, 78, 77, 77, 77},
        {78, 78, 78, 79, 79, 78, 78, 78},
        {78, 78, 78, 80, 79, 78, 78, 78}
    };

// Left reference pixels (17 pixels)
static const unsigned char left_ref[17] = {
        80, 78, 78, 77, 78, 77, 77, 77, 76, 76, 76, 76, 76, 76, 76, 76, 76
};

// Top reference pixels (17 pixels)
static const unsigned char top_ref[17] = {
        80, 80, 80, 80, 80, 80, 80, 80, 80, 78, 79, 79, 80, 80, 81, 81, 82
};

// Reference prediction matrices generated by exact Kvazaar implementation
static const unsigned char reference_predictions[35][8][8] = {
  // Mode 0
  {
    { 79, 79, 79, 79, 79, 79, 79, 79},
    { 79, 79, 79, 79, 79, 79, 79, 79},
    { 78, 78, 78, 79, 79, 79, 79, 79},
    { 78, 78, 78, 78, 78, 78, 78, 79},
    { 77, 78, 78, 78, 78, 78, 78, 78},
    { 77, 77, 77, 78, 78, 78, 78, 78},
    { 77, 77, 77, 77, 77, 78, 78, 78},
    { 76, 76, 77, 77, 77, 77, 77, 78}
  },
  // Mode 1
  {
    { 79, 79, 79, 79, 79, 79, 79, 79},
    { 79, 79, 79, 79, 79, 79, 79, 79},
    { 79, 79, 79, 79, 79, 79, 79, 79},
    { 79, 79, 79, 79, 79, 79, 79, 79},
    { 79, 79, 79, 79, 79, 79, 79, 79},
    { 79, 79, 79, 79, 79, 79, 79, 79},
    { 79, 79, 79, 79, 79, 79, 79, 79},
    { 78, 79, 79, 79, 79, 79, 79, 79}
  },
  // Mode 2
  {
    { 78, 78, 78, 77, 77, 77, 76, 76},
    { 78, 78, 77, 77, 77, 76, 76, 76},
    { 78, 77, 77, 77, 76, 76, 76, 76},
    { 77, 77, 77, 76, 76, 76, 76, 76},
    { 77, 77, 76, 76, 76, 76, 76, 76},
    { 77, 76, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76}
  },
  // Mode 3
  {
    { 78, 77, 77, 78, 77, 77, 77, 77},
    { 77, 78, 78, 77, 77, 77, 76, 76},
    { 78, 77, 77, 77, 77, 76, 76, 76},
    { 77, 77, 77, 77, 76, 76, 76, 76},
    { 77, 77, 77, 76, 76, 76, 76, 76},
    { 77, 76, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76}
  },
  // Mode 4
  {
    { 78, 78, 77, 78, 78, 77, 77, 77},
    { 77, 77, 78, 77, 77, 77, 77, 77},
    { 78, 78, 77, 77, 77, 77, 76, 76},
    { 77, 77, 77, 77, 77, 76, 76, 76},
    { 77, 77, 77, 76, 76, 76, 76, 76},
    { 77, 77, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76}
  },
  // Mode 5
  {
    { 78, 78, 77, 77, 78, 78, 77, 77},
    { 77, 77, 78, 78, 77, 77, 77, 77},
    { 78, 78, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 76, 76},
    { 77, 77, 77, 77, 76, 76, 76, 76},
    { 77, 77, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76}
  },
  // Mode 6
  {
    { 78, 78, 78, 77, 77, 77, 78, 78},
    { 78, 77, 77, 78, 78, 78, 77, 77},
    { 77, 78, 78, 77, 77, 77, 77, 77},
    { 78, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 76, 76},
    { 77, 77, 77, 76, 76, 76, 76, 76},
    { 77, 76, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76}
  },
  // Mode 7
  {
    { 78, 78, 78, 78, 78, 77, 77, 77},
    { 78, 77, 77, 77, 77, 78, 78, 78},
    { 77, 78, 78, 78, 78, 77, 77, 77},
    { 78, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 76, 76, 76},
    { 77, 76, 76, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76}
  },
  // Mode 8
  {
    { 78, 78, 78, 78, 78, 78, 78, 78},
    { 78, 78, 78, 77, 77, 77, 77, 77},
    { 77, 77, 77, 78, 78, 78, 78, 78},
    { 78, 78, 78, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 76, 76, 76, 76, 76},
    { 76, 76, 76, 76, 76, 76, 76, 76}
  },
  // Mode 9
  {
    { 78, 78, 78, 78, 78, 78, 78, 78},
    { 78, 78, 78, 78, 78, 78, 78, 78},
    { 77, 77, 77, 77, 77, 77, 77, 78},
    { 78, 78, 78, 78, 78, 78, 78, 78},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 76, 76, 76, 76, 76, 76, 76, 76}
  },
  // Mode 10
  {
    { 78, 78, 78, 78, 78, 78, 78, 78},
    { 78, 78, 78, 78, 78, 78, 78, 78},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 78, 78, 78, 78, 78, 78, 78, 78},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 76, 76, 76, 76, 76, 76, 76, 76}
  },
  // Mode 11
  {
    { 78, 78, 78, 79, 79, 79, 79, 79},
    { 78, 78, 78, 78, 78, 78, 78, 78},
    { 77, 77, 77, 77, 77, 77, 77, 78},
    { 78, 78, 78, 78, 78, 78, 78, 78},
    { 77, 77, 77, 77, 77, 77, 77, 78},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 76, 76, 76, 76, 76, 76, 76, 77}
  },
  // Mode 12
  {
    { 78, 79, 79, 79, 80, 80, 80, 80},
    { 78, 78, 78, 78, 78, 78, 78, 79},
    { 77, 77, 77, 78, 78, 78, 78, 78},
    { 78, 78, 78, 77, 77, 77, 77, 77},
    { 77, 77, 77, 78, 78, 78, 78, 78},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 76, 76, 76, 77, 77, 77, 77, 77}
  },
  // Mode 13
  {
    { 79, 79, 80, 80, 80, 80, 80, 80},
    { 78, 78, 78, 78, 79, 79, 80, 80},
    { 77, 78, 78, 78, 78, 78, 78, 79},
    { 78, 77, 77, 77, 77, 78, 78, 78},
    { 77, 78, 78, 78, 78, 77, 77, 77},
    { 77, 77, 77, 77, 77, 78, 78, 78},
    { 77, 77, 77, 77, 77, 77, 77, 77},
    { 76, 77, 77, 77, 77, 77, 77, 77}
  },
  // Mode 14
  {
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 78, 78, 78, 79, 80, 80, 80, 80},
    { 77, 78, 78, 78, 78, 79, 80, 80},
    { 78, 77, 77, 78, 78, 78, 78, 79},
    { 77, 78, 78, 77, 77, 77, 78, 78},
    { 77, 77, 77, 78, 78, 78, 77, 77},
    { 77, 77, 77, 77, 77, 77, 78, 78},
    { 76, 77, 77, 77, 77, 77, 77, 77}
  },
  // Mode 15
  {
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 78, 78, 79, 80, 80, 80, 80, 80},
    { 78, 78, 78, 78, 79, 80, 80, 80},
    { 77, 77, 78, 78, 78, 78, 79, 80},
    { 78, 78, 77, 77, 78, 78, 78, 79},
    { 77, 77, 78, 78, 77, 77, 78, 78},
    { 77, 77, 77, 77, 78, 78, 77, 77},
    { 77, 77, 77, 77, 77, 77, 78, 78}
  },
  // Mode 16
  {
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 78, 79, 80, 80, 80, 80, 80, 80},
    { 78, 78, 78, 79, 80, 80, 80, 80},
    { 77, 77, 78, 78, 79, 80, 80, 80},
    { 78, 78, 77, 78, 78, 78, 79, 80},
    { 77, 77, 78, 77, 77, 78, 78, 79},
    { 77, 77, 77, 78, 78, 77, 78, 78},
    { 77, 77, 77, 77, 77, 78, 77, 77}
  },
  // Mode 17
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 78, 79, 80, 80, 80, 80, 80, 80},
    { 78, 78, 79, 80, 80, 80, 80, 80},
    { 77, 78, 78, 79, 80, 80, 80, 80},
    { 78, 77, 77, 78, 78, 80, 80, 80},
    { 77, 78, 78, 77, 78, 78, 79, 80},
    { 77, 77, 77, 78, 77, 78, 78, 79},
    { 77, 77, 77, 77, 78, 77, 78, 78}
  },
  // Mode 18
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 78, 79, 80, 80, 80, 80, 80, 80},
    { 78, 78, 79, 80, 80, 80, 80, 80},
    { 78, 78, 78, 79, 80, 80, 80, 80},
    { 77, 78, 78, 78, 79, 80, 80, 80},
    { 77, 77, 78, 78, 78, 79, 80, 80},
    { 77, 77, 77, 78, 78, 78, 79, 80}
  },
  // Mode 19
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 78, 79, 80, 80, 80, 80, 80, 80},
    { 78, 78, 80, 80, 80, 80, 80, 80},
    { 78, 78, 78, 80, 80, 80, 80, 80},
    { 77, 78, 78, 78, 80, 80, 80, 80},
    { 77, 77, 78, 78, 79, 80, 80, 80},
    { 77, 77, 78, 78, 78, 79, 80, 80}
  },
  // Mode 20
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 78, 80, 80, 80, 80, 80, 80, 80},
    { 77, 79, 80, 80, 80, 80, 80, 80},
    { 77, 78, 79, 80, 80, 80, 80, 80},
    { 77, 77, 78, 80, 80, 80, 80, 80},
    { 77, 77, 77, 79, 80, 80, 80, 80},
    { 77, 77, 77, 78, 80, 80, 80, 80}
  },
  // Mode 21
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 78, 80, 80, 80, 80, 80, 80, 80},
    { 78, 79, 80, 80, 80, 80, 80, 80},
    { 78, 78, 80, 80, 80, 80, 80, 80},
    { 77, 78, 79, 80, 80, 80, 80, 80},
    { 77, 78, 78, 80, 80, 80, 80, 80}
  },
  // Mode 22
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 78, 80, 80, 80, 80, 80, 80, 80},
    { 78, 79, 80, 80, 80, 80, 80, 80},
    { 77, 78, 80, 80, 80, 80, 80, 80},
    { 77, 78, 80, 80, 80, 80, 80, 80}
  },
  // Mode 23
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 79, 80, 80, 80, 80, 80, 80, 80},
    { 78, 80, 80, 80, 80, 80, 80, 80},
    { 78, 80, 80, 80, 80, 80, 80, 80}
  },
  // Mode 24
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 79, 80, 80, 80, 80, 80, 80, 80}
  },
  // Mode 25
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80}
  },
  // Mode 26
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80}
  },
  // Mode 27
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 79}
  },
  // Mode 28
  {
    { 80, 80, 80, 80, 80, 80, 80, 80},
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 78},
    { 80, 80, 80, 80, 80, 80, 80, 78},
    { 80, 80, 80, 80, 80, 80, 80, 78},
    { 80, 80, 80, 80, 80, 80, 80, 78}
  },
  // Mode 29
  {
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 78},
    { 80, 80, 80, 80, 80, 80, 80, 78},
    { 80, 80, 80, 80, 80, 80, 79, 78},
    { 80, 80, 80, 80, 80, 80, 79, 79},
    { 80, 80, 80, 80, 80, 80, 78, 79},
    { 80, 80, 80, 80, 80, 80, 78, 79}
  },
  // Mode 30
  {
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 78},
    { 80, 80, 80, 80, 80, 80, 80, 78},
    { 80, 80, 80, 80, 80, 80, 79, 79},
    { 80, 80, 80, 80, 80, 80, 78, 79},
    { 80, 80, 80, 80, 80, 79, 78, 79},
    { 80, 80, 80, 80, 80, 78, 79, 79},
    { 80, 80, 80, 80, 80, 78, 79, 79}
  },
  // Mode 31
  {
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 80, 78},
    { 80, 80, 80, 80, 80, 80, 79, 79},
    { 80, 80, 80, 80, 80, 80, 78, 79},
    { 80, 80, 80, 80, 80, 79, 79, 79},
    { 80, 80, 80, 80, 80, 78, 79, 79},
    { 80, 80, 80, 80, 79, 79, 79, 80},
    { 80, 80, 80, 80, 78, 79, 79, 80}
  },
  // Mode 32
  {
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 79, 78},
    { 80, 80, 80, 80, 80, 80, 78, 79},
    { 80, 80, 80, 80, 80, 79, 79, 79},
    { 80, 80, 80, 80, 79, 78, 79, 79},
    { 80, 80, 80, 80, 78, 79, 79, 80},
    { 80, 80, 80, 79, 79, 79, 80, 80},
    { 80, 80, 80, 78, 79, 79, 80, 80}
  },
  // Mode 33
  {
    { 80, 80, 80, 80, 80, 80, 80, 78},
    { 80, 80, 80, 80, 80, 80, 79, 79},
    { 80, 80, 80, 80, 80, 79, 78, 79},
    { 80, 80, 80, 80, 80, 78, 79, 79},
    { 80, 80, 80, 80, 78, 79, 79, 80},
    { 80, 80, 80, 78, 79, 79, 80, 80},
    { 80, 80, 79, 79, 79, 80, 80, 81},
    { 80, 79, 79, 79, 80, 80, 81, 81}
  },
  // Mode 34
  {
    { 80, 80, 80, 80, 80, 80, 80, 79},
    { 80, 80, 80, 80, 80, 80, 79, 79},
    { 80, 80, 80, 80, 80, 79, 79, 79},
    { 80, 80, 80, 80, 79, 79, 79, 80},
    { 80, 80, 80, 79, 79, 79, 80, 80},
    { 80, 80, 79, 79, 79, 80, 80, 81},
    { 80, 79, 79, 79, 80, 80, 81, 81},
    { 79, 79, 79, 80, 80, 81, 81, 82}
  }
};
